# act-runner-controller values
# Job-aware autoscaler for act_runner scale sets.
# Polls the Forgejo/Gitea REST API for pending jobs and scales
# runner Deployments/StatefulSets up or down accordingly.

# -- Number of controller replicas
replicaCount: 1

image:
  # -- Controller image repository
  repository: ghcr.io/00o-sh/act_runner
  # -- Image pull policy
  pullPolicy: IfNotPresent
  # -- Image tag override (defaults to appVersion-controller)
  tag: ""

# -- Image pull secrets for private registries
imagePullSecrets: []

# -- Override the chart name
nameOverride: ""
# -- Override the full release name
fullnameOverride: ""

# Forgejo / Gitea instance configuration
forgejo:
  # -- (required) Forgejo instance URL (e.g. https://forgejo.example.com)
  url: ""
  # -- API token with admin or org-level permissions to read runners and jobs.
  # If set (and apiTokenSecret.name is empty), the chart creates a Secret for you.
  apiToken: ""
  # -- Reference a pre-existing Secret instead of having the chart create one.
  apiTokenSecret:
    # -- Name of the pre-existing Secret
    name: ""
    # -- Key inside the Secret that holds the API token
    key: "token"
  # -- API scope: "admin" uses /api/v1/admin/actions/* endpoints,
  # "org" uses /api/v1/orgs/{org}/actions/* endpoints.
  scope: "admin"
  # -- Forgejo organization name (only used when scope=org)
  org: ""

# -- How often (seconds) the controller reconciles runner replicas
reconcileInterval: 30

# -- How long (seconds) runners must be idle before scaling down
scaleDownDelay: 300

serviceAccount:
  # -- Create a service account for the controller
  create: true
  # -- Annotations for the service account
  annotations: {}
  # -- Service account name override
  name: ""

# -- Additional labels to add to all resources
additionalLabels: {}

# -- Additional annotations to add to all resources
additionalAnnotations: {}

# -- Pod-level annotations
podAnnotations: {}

# -- Pod-level security context
podSecurityContext: {}

# -- Container-level security context
securityContext: {}

resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 50m
  #   memory: 64Mi

# -- Node selector for controller pods
nodeSelector: {}

# -- Tolerations for controller pods
tolerations: []

# -- Affinity rules for controller pods
affinity: {}

# -- Priority class for controller pods
priorityClassName: ""

# RBAC configuration
rbac:
  # -- Create RBAC resources (ClusterRole, ClusterRoleBinding)
  create: true
  # -- Watch all namespaces or only the release namespace
  watchAllNamespaces: true
